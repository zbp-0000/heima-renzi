<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>
  <script>
    const headers = {
      手机号: "mobile",
      姓名: "username",
      入职日期: "timeOfEntry",
      聘用形式: "formOfEmployment",
      转正日期: "correctionTime",
      工号: "workNumber",
      部门: "departmentName",
    };
    const rows = [
      {
        id: "1063705989926227968",
        mobile: "13800000002",
        username: "祁文博",
        password: "c8b7722b1139bb9b346409e503302e82",
        enableState: 1,
        createTime: "2018-11-17T16:10:45.000+0000",
        companyId: "1",
        companyName: "传智播客",
        departmentId: "1175310929766055936",
        timeOfEntry: "2018-11-02T08:00:00.000+0000",
        formOfEmployment: 1,
        workNumber: "9002022",
        formOfManagement: null,
        workingCity: null,
        correctionTime: "2018-11-30T00:00:00.000+0000",
        inServiceStatus: 1,
        departmentName: "总裁办",
        level: "coAdmin",
        staffPhoto:
          "http://xiaobai-1313307828.cos.ap-nanjing.myqcloud.com/PUPI9%24QC%5B4%5B_%5DKMNJ6%25%7B%7D~C.jpg",
      },
      {
        id: "1066370498633486336",
        mobile: "13800000003",
        username: "孙财",
        password: "14af10ffa3798486632a79cbbf469376",
        enableState: 1,
        createTime: null,
        companyId: "1",
        companyName: "传智播客",
        departmentId: "1175311466846683136",
        timeOfEntry: "2018-11-04T08:00:00.000+0000",
        formOfEmployment: 1,
        workNumber: "1111",
        formOfManagement: null,
        workingCity: null,
        correctionTime: "2018-11-20T00:00:00.000+0000",
        inServiceStatus: 1,
        departmentName: "市场部",
        level: "user",
        staffPhoto: " ",
      },
    ];

    /*
    目标data格式
    data = [
      ['13800000002', '纪同伟'，...], []
    ]
    */
    const data = rows.map(t => {
        const n = pick(t, Object.values(headers))
        return Object.values(n)
      })

      excel.export_json_to_excel({
        header: Object.keys(headers),
        data,
        filename: 'excel-list',
        autoWidth: true,
        bookType: 'xlsx'
      })
  </script>
</html>
